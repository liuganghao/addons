<?xml version='1.0' encoding='utf-8'?>
<openerp>
    <data>
        <!--供应商付款-->
        <record model="ir.ui.view" id="view_vendor_payment_form_inherit">
            <field name="name">account.voucher.form.inherit</field>
            <field name="model">account.voucher</field>
            <field name="inherit_id" ref="account_voucher.view_vendor_payment_form"/>
            <field name="arch" type="xml">

                <xpath expr="//field[@name='journal_id']" position="after">
                    <field name="analytic_obj" on_change="onchange_partner_id(partner_id, journal_id, amount, currency_id, type, date,analytic_obj, context)" domain="[('log','=',False)]" attrs="{'readonly':[('state','=','posted')]}"/>
                    <field name="is_close" attrs="{'readonly':[('state','=','posted')]}"/>
                </xpath>

                <xpath expr="//field[@name='partner_id']" position="replace">
                    <field name="partner_id" required="1" invisible="context.get('line_type', False)" on_change="onchange_partner_id(partner_id, journal_id, amount, currency_id, type, date,analytic_obj, context)" context="{'invoice_currency':currency_id, 'default_customer': 0, 'search_default_supplier': 1, 'default_supplier': 1}"  string="Supplier"/>
                </xpath>

                <xpath expr="//field[@name='amount']" position="replace">
                    <field name="amount" invisible="context.get('line_type', False)" on_change="onchange_amount(amount, payment_rate, partner_id, journal_id, currency_id, type, date, payment_rate_currency_id, company_id, analytic_obj, context)" class="oe_inline" widget='monetary' options='{"currency_field": "currency_id"}'/>
                </xpath>

                <xpath expr="//field[@name='payment_rate']" position="replace">
                    <field name="payment_rate" required="1" class="oe_inline" on_change="onchange_amount(amount, payment_rate, partner_id, journal_id, currency_id, type, date, payment_rate_currency_id, company_id,analytic_obj, context)"/>
                </xpath>

                <xpath expr="//field[@name='journal_id']" position="replace">
                    <field name="journal_id"
                                domain="[('type','in',['bank', 'cash'])]"
                                invisible="context.get('line_type', False)"
                                widget="selection"
                                on_change="onchange_journal(journal_id, line_dr_ids, False, partner_id, date, amount, type, company_id, analytic_obj, context)"
                                string="Payment Method"/>
                </xpath>

            </field>
        </record>

        <!--产品属性-->
        <!--<record model="ir.ui.view" id="product_template_only_form_view_inherit">-->
            <!--<field name="name">product.template.form.inherit</field>-->
            <!--<field name="model">product.template</field>-->
            <!--<field name="inherit_id" ref="product.product_template_only_form_view"/>-->
            <!--<field name="arch" type="xml">-->

                <!--<xpath expr="//field[@name='list_price']" position="after">-->
                    <!--<field name="brand_id"/>-->
                    <!--<field name="version_id" domain="[('order_id','=',brand_id)]"/>-->
                    <!--<field name="series_id" domain="[('order_id','=',version_id),('brand_id','=',brand_id)]"/>-->
                    <!--<field name="year_id" domain="[('order_id','=',series_id),('brand_id','=',brand_id),('version_id','=',version_id)]"/>-->
                    <!--<field name="model_id" domain="[('order_id','=',year_id),('series_id','=',series_id),('version_id','=',version_id),('brand_id','=',brand_id)]"/>-->
                <!--</xpath>-->

                <!--<xpath expr="//field[@name='default_code']" position="after">-->
                    <!--<field name="appearance_id" domain="[('order_id','=',model_id),('year_id','=',year_id),('series_id','=',series_id),('version_id','=',version_id),('brand_id','=',brand_id)]"/>-->
                    <!--<field name="interior_id" domain="[('order_id','=',appearance_id),('year_id','=',year_id),('model_id','=',model_id),('series_id','=',series_id),('version_id','=',version_id),('brand_id','=',brand_id)]"/>-->
                    <!--<field name="configuration_id" domain="[('order_id','=',interior_id),('appearance_id','=',appearance_id),('model_id','=',model_id),('year_id','=',year_id),('series_id','=',series_id),('version_id','=',version_id),('brand_id','=',brand_id)]"/>-->
                <!--</xpath>-->

            <!--</field>-->
        <!--</record>-->

        <!--产品属性-->
        <!--<record model="ir.ui.view" id="product_normal_form_view_inherit">-->
            <!--<field name="name">product.product.form.inherit</field>-->
            <!--<field name="model">product.product</field>-->
            <!--<field name="inherit_id" ref="product.product_normal_form_view"/>-->
            <!--<field name="arch" type="xml">-->

                <!--<xpath expr="//field[@name='lst_price']" position="after">-->
                    <!--<field name="brand_id"/>-->
                    <!--<field name="version_id" domain="[('order_id','=',brand_id)]"/>-->
                    <!--<field name="series_id" domain="[('order_id','=',version_id),('brand_id','=',brand_id)]"/>-->
                    <!--<field name="year_id" domain="[('order_id','=',series_id),('brand_id','=',brand_id),('version_id','=',version_id)]"/>-->
                    <!--<field name="model_id" domain="[('order_id','=',year_id),('series_id','=',series_id),('version_id','=',version_id),('brand_id','=',brand_id)]"/>-->
                <!--</xpath>-->

                <!--<xpath expr="//field[@name='default_code']" position="after">-->
                    <!--<field name="appearance_id" domain="[('order_id','=',model_id),('year_id','=',year_id),('series_id','=',series_id),('version_id','=',version_id),('brand_id','=',brand_id)]"/>-->
                    <!--<field name="interior_id" domain="[('order_id','=',appearance_id),('year_id','=',year_id),('model_id','=',model_id),('series_id','=',series_id),('version_id','=',version_id),('brand_id','=',brand_id)]"/>-->
                    <!--<field name="configuration_id" domain="[('order_id','=',interior_id),('appearance_id','=',appearance_id),('model_id','=',model_id),('year_id','=',year_id),('series_id','=',series_id),('version_id','=',version_id),('brand_id','=',brand_id)]"/>-->
                <!--</xpath>-->

            <!--</field>-->
        <!--</record>-->

        <!--反向转移修改-->
        <record model="ir.ui.view" id="view_stock_return_picking_form_inherit">
            <field name="name">stock.return.picking.form.inherit</field>
            <field name="model">stock.return.picking</field>
            <field name="inherit_id" ref="stock.view_stock_return_picking_form"/>
            <field name="arch" type="xml">

                <xpath expr="//field[@name='lot_id']" position="after">
                    <field name="car_number" domain="[('car_model','=',product_id)]"/>
                </xpath>

            </field>
        </record>

        <!--银行账户增加默认值-->
        <record model="ir.ui.view" id="view_partner_bank_form_inherit">
            <field name="name">res.partner.bank.form.inherit</field>
            <field name="model">res.partner.bank</field>
            <field name="inherit_id" ref="base.view_partner_bank_form"/>
            <field name="arch" type="xml">

                <xpath expr="//field[@name='acc_number']" position="after">
                    <field name="is_defaults"/>
                </xpath>

            </field>
        </record>
        <record model="ir.ui.view" id="view_partner_property_form_inherit">
            <field name="name">res.partner.property.inherit</field>
            <field name="model">res.partner</field>
            <field name="inherit_id" ref="account.view_partner_property_form"/>
            <field name="arch" type="xml">

                <xpath expr="//field[@name='owner_name']" position="after">
                    <field name="is_defaults"/>
                </xpath>

            </field>
        </record>

        <!--仓库转移增加车架号-->
        <record model="ir.ui.view" id="view_qdodoo_stock_enter_transfer_details_inherit">
            <field name="name">stock.transfer_details.form.inherit</field>
            <field name="model">stock.transfer_details</field>
            <field name="inherit_id" ref="stock.view_stock_enter_transfer_details"/>
            <field name="arch" type="xml">

                <xpath expr="//field[@name='quantity']" position="after">
                    <field name="car_name" domain="[('car_model','=',product_id),('is_sale','=',False)]"/>
                </xpath>

            </field>
        </record>

        <!--选择付款方式页面（已无效）-->
        <record id="view_form_qdodoo_payment_model" model="ir.ui.view">
            <field name="name">qdodoo.payment.model.form</field>
            <field name="model">qdodoo.payment.model</field>
            <field name="arch" type="xml">
                <form string="付款方式">
                    <sheet>
                        <div>
                            请先选择付款方式
                        </div>
                        <field name="name"/>
                    </sheet>
                    <footer>
                        <button name="search_date" string="查看付款申请" type="object" default_focus="1"
                                context="{'name':name}" class="oe_highlight"/>
                    </footer>
                </form>
            </field>
        </record>

        <!--整车采购-->
        <record id="view_search_qdodoo_car_in_contract" model="ir.ui.view">
            <field name="name">qdodoo.car.in.contract.search</field>
            <field name="model">qdodoo.car.in.contract</field>
            <field name="arch" type="xml">
                <search string="名称">
                    <filter name="state" string="草稿" domain="[('state', '=', 'draft')]"/>
                    <filter name="state" string="询价" domain="[('state', '=', 'sent')]"/>
                    <filter name="state" string="合同确认" domain="[('state', '=', 'confirmed')]"/>
                    <filter name="state" string="支付定金" domain="[('state', '=', 'approved')]"/>
                    <filter name="state" string="委托协议" domain="[('state', '=', 'except_picking')]"/>
                    <filter name="state" string="装船" domain="[('state', '=', 'in_ship')]"/>
                    <filter name="state" string="结算" domain="[('state', '=', 'except_invoice')]"/>
                    <filter name="state" string="完成" domain="[('state', '=', 'done')]"/>
                    <filter name="state" string="取消" domain="[('state', '=', 'cancel')]"/>
                </search>
            </field>
        </record>
        <record id="view_form_qdodoo_car_in_contract" model="ir.ui.view">
            <field name="name">qdodoo.car.in.contract.form</field>
            <field name="model">qdodoo.car.in.contract</field>
            <field name="arch" type="xml">
                <form string="整车采购">
                    <header>
                        <field name="is_payment" invisible="True"/>
                        <field name="new_id" invisible="True"/>
                        <button name="wkf_send_rfq" states="draft" string="电邮" type="object"
                                context="{'contract_id':True,'is_contract':True}" class="oe_highlight"/>
                        <button name="wkf_send_rfq" states="sent" string="重发电邮" type="object"
                                context="{'contract_id':True}" class="oe_highlight"/>
                        <button name="print_quotation" string="打印" type="object" states="draft" class="oe_highlight"
                                groups="base.group_user"/>
                        <button name="print_quotation" string="重新打印" type="object" states="sent" class="oe_highlight"
                                groups="base.group_user"/>
                        <button name="btn_message" string="短信" type="object" states="draft" class="oe_highlight"
                                groups="base.group_user"/>
                        <button name="btn_message" string="重发短信" type="object" states="sent" class="oe_highlight"
                                groups="base.group_user"/>
                        <button name="purchase_confirm" string="提交订单" states="draft,sent"/>
                        <button name="confirm_contract" string="确认订单" states="confirmed"/>
                        <button name="btn_confirmed_sent" string="驳回" states="confirmed"/>
                        <button name="btn_create_contract" string="签进口合同" states="approved" type="object"/>
                        <button name="btn_cancel_contract" string="驳回"
                                attrs="{'invisible':['|','|',('new_id','!=',False),('state','!=','approved'),('contract_type','=','in')]}"/>
                        <button name="btn_payment_message" string="付款申请" states="lc" type="object"/>
                        <button name="btn_entrust_agent" string="委托代理" states="except_picking" type="object"/>
                        <button name="btn_cancel_contract_agent" string="驳回" states="except_picking" type="object"/>
                        <button name="btn_bill" string="收货通知单" states="customs" type="object"/>
                        <button name="btn_bill_customs" string="报关报检" states="customs" type="object"/>
                        <button name="btn_bill_redeem" string="赎车" states="customs" type="object"/>
                        <button name="btn_bill_payment" string="结算" attrs="{'invisible':['|',('state','!=','customs'),('contract_type','!=','in')]}" type="object"/>
                        <button name="btn_redeem" string="创建赎车单" states="car" type="object"/>
                        <button name="btn_redeem_bill" string="收货通知" states="car" type="object"/>
                        <button name="btn_redeem_customs" string="报关报检" states="car" type="object"/>
                        <button name="btn_confirmed_done" string="下一步" states="customs_dec" type="object"/>
                        <button name="btn_confirmed_bill" string="收货通知" states="customs_dec" type="object"/>
                        <button name="btn_payment_order" string="结算单" states="except_invoice" type="object"/>
                        <button name="btn_payment_order_done" string="结算完成" states="except_invoice" type="object"/>
                        <button name="action_cancel" states="draft,sent" string="取消" type="object"/>
                        <field name="state" widget="statusbar" statusbar_visible="draft,confirmed,customs,done"
                               statusbar_colors='{"confirm_contract":"red"}' readonly="1"/>
                    </header>
                    <sheet>
                        <div class="oe_title">
                            <h1>
                                <label string="整车采购订单"/>
                                <field name="name" class="oe_inline" readonly="1"/>
                            </h1>
                        </div>
                        <div class="oe_right oe_button_box" name="buttons">
                            <button name="btn_read_payment_order" icon="gtk-execute" string="账务" type="object"/>
                            <button name="btn_read_bill_lading" icon="gtk-execute" string="进口合同" type="object"/>
                            <button name="btn_read_entrusted_agency" icon="gtk-execute" string="委托协议" type="object"/>
                        </div>
                        <div class="oe_right oe_button_box" name="buttons">
                            <button name="btn_receive_notice" icon="gtk-execute" string="收货通知" type="object"/>
                            <button name="btn_payment_in" icon="gtk-execute" string="费用" type="object"/>
                            <button name="btn_select_redeem" icon="gtk-execute" string="赎车单" type="object"/>
                        </div>
                        <group>
                            <group>
                                <field name="customer_id" invisible="True"/>
                                <field name="partner_id" attrs="{'readonly':[('state','!=','draft')],'required':True}"
                                       string="供应商" on_change="onchange_partner_id(partner_id, context)"
                                       context="{'search_default_supplier':1, 'default_supplier':1, 'default_customer':0}"
                                       domain="[('supplier','=',True)]"/>
                                <field string="价格表" attrs="{'readonly':[('state','not in',('draft'))]}"
                                       domain="[('type','=','purchase')]" name="pricelist_id"
                                       groups="product.group_purchase_pricelist"
                                       on_change="onchange_pricelist(pricelist_id, context)"/>
                                <field name="currency_id" attrs="{'readonly':[('state','not in',('draft'))]}"
                                       groups="base.group_multi_currency"/>
                                <field name="journal_id" invisible='1'/>
                                <field name="supplier_contract_version" domain="[('partner_id','=',partner_id)]"
                                       attrs="{'readonly':[('state','not in',('draft'))]}"/>
                                <field name="car_type" invisible="True"/>
                                <field name="deposit_rate" on_change="onchange_deposit_amount(deposit_rate)"
                                       attrs="{'readonly':[('state','not in',('draft','sent','confirmed'))]}"/>
                                <field name="deposit_amount"
                                       attrs="{'readonly':[('state','not in',('draft','sent','confirmed'))]}"/>
                                <field name="deposit_margin"
                                       attrs="{'readonly':[('state','not in',('draft','sent','confirmed'))]}"/>
                                <field name="deposit_margin_customer"
                                       attrs="{'invisible':['|',('purchase_type','=','own'),('state','in',('draft','sent','confirmed','approved','except_picking'))],'readonly':True}"/>
                                <field name="contract_number"
                                       attrs="{'readonly':True,'invisible':['|',('purchase_type','=','own'),('state','in',('draft','sent','confirmed','approved'))]}"/>
                                <field name="contract_date"
                                       attrs="{'readonly':True,'invisible':['|',('purchase_type','=','own'),('state','in',('draft','sent','confirmed','approved'))]}"/>
                            </group>
                            <group>
                                <field name="receive_id" attrs="{'invisible':[('state','in',('draft','sent','confirmed','approved','except_picking'))],'readonly':True}"/>
                                <field name="purchase_type" invisible="True"/>
                                <field name="contract_type"
                                       attrs="{'invisible':[('state','in',('draft','sent'))],'readonly':[('state','not in',('draft','sent','confirmed'))]}"/>
                                <field name="date_order" string="订单日期" readonly="True"/>
                                <field name="in_port"
                                       attrs="{'readonly':[('state','not in',('draft','sent','confirmed'))]}"/>
                                <field name="out_port" attrs="{'readonly':[('state','not in',('draft','sent'))]}"/>
                                <!--<field name="partial_shipment" attrs="{'readonly':[('state','not in',('draft','sent'))],'invisible':[('state','=','draft')],'required':[('state','=','sent')]}"/>-->
                                <!--<field name="trans_shipment" attrs="{'readonly':[('state','not in',('draft','sent'))],'invisible':[('state','=','draft')],'required':[('state','=','sent')]}"/>-->
                                <field name="payment_type"
                                       attrs="{'required':True,'readonly':[('state','not in',('draft','sent'))]}"/>
                                <field name="payment_line" attrs="{'readonly':[('state','not in',('draft','sent'))]}"/>
                                <field name="last_ship_date"
                                       attrs="{'readonly':[('state','not in',('draft','sent'))]}"/>
                                <field name="origin" attrs="{'invisible': [('origin','=',False)]}"/>
                                <field name="company_id" string="公司" invisible="True" groups="base.group_multi_company"
                                       options="{'no_create': True}"/>
                                <field name="picking_type_id" invisible="True"
                                       on_change="onchange_picking_type_id(picking_type_id, context)"
                                       domain="[('code','=','incoming')]" options="{'no_create': True}"
                                       context="{'special_shortened_wh_name': True}" groups="stock.group_locations"/>
                                <field name="related_usage" invisible="1"/>
                                <field name="dest_address_id" string="Customer Address"
                                       on_change="onchange_dest_address_id(dest_address_id, context)"
                                       attrs="{'invisible':[('related_usage','!=','customer')],
                                    'required': [('related_usage','=', 'customer')]}"
                                       groups="stock.group_locations"/>
                                <!--<field name="file_name" invisible="True"/>-->
                                <!--<field name="contract_note" filename="file_name"-->
                                       <!--attrs="{'invisible':['|',('purchase_type','=','own'),('state','in',('draft','sent','confirmed','approved'))],'readonly':[('state','not in',('draft','sent','confirmed'))]}"/>-->
                            </group>
                        </group>
                        <notebook>
                            <page string="货物明细">
                                <field name="order_line" attrs="{'readonly':[('state','not in',('draft','sent','confirmed'))]}">
                                    <form string="Purchase Order Line">
                                        <sheet>
                                            <group>
                                                <group>
                                                    <!--<label string="品牌、版本、系列"/>-->
                                                    <!--<div>-->
                                                        <!--<field name="brand_id" style="width: 33%"/>-->
                                                        <!--<field name="version_id" domain="[('order_id','=',brand_id)]" style="width: 33%"/>-->
                                                        <!--<field name="series_id" domain="[('order_id','=',version_id),('brand_id','=',brand_id)]" style="width: 33%"/>-->
                                                    <!--</div>-->
                                                    <!--<label string="年款、型号"/>-->
                                                    <!--<div>-->
                                                        <!--<field name="year_id" domain="[('order_id','=',series_id),('version_id','=',version_id),('brand_id','=',brand_id)]" style="width: 50%"/>-->
                                                        <!--<field name="model_id" domain="[('order_id','=',year_id),('series_id','=',series_id),('version_id','=',version_id),('brand_id','=',brand_id)]" style="width: 50%"/>-->
                                                    <!--</div>-->
                                                    <!--<label string="外观、内饰、配置"/>-->
                                                    <!--<div>-->
                                                        <!--<field name="appearance_id" domain="[('order_id','=',model_id),('year_id','=',year_id),('series_id','=',series_id),('version_id','=',version_id),('brand_id','=',brand_id)]" style="width: 33%"/>-->
                                                        <!--<field name="interior_id" domain="[('order_id','=',appearance_id),('model_id','=',model_id),('year_id','=',year_id),('series_id','=',series_id),('version_id','=',version_id),('brand_id','=',brand_id)]" style="width: 33%"/>-->
                                                        <!--<field name="configuration_id" domain="[('order_id','=',interior_id),('appearance_id','=',appearance_id),('model_id','=',model_id),('year_id','=',year_id),('series_id','=',series_id),('version_id','=',version_id),('brand_id','=',brand_id)]" style="width: 33%"/>-->
                                                    <!--</div>-->
                                                    <field name="product_id" options="{'no_create': True,'no_open':True}" on_change="onchange_product_id(parent.pricelist_id,product_id,0,False,parent.partner_id, parent.date_order,parent.fiscal_position,date_planned,False,False,'draft',context)"/>
                                                    <label for="product_qty"/>
                                                    <div>
                                                        <field name="product_qty" on_change="onchange_product_id(parent.pricelist_id,product_id,product_qty,product_uom,parent.partner_id,parent.date_order,parent.fiscal_position,date_planned,name,False,'draft',context)" class="oe_inline"/>
                                                        <field name="product_uom" groups="product.group_uom" on_change="onchange_product_uom(parent.pricelist_id,product_id,product_qty,product_uom,parent.partner_id, parent.date_order,parent.fiscal_position,date_planned,name,False,'draft',context)" class="oe_inline"/>
                                                    </div>
                                                    <field name="price_unit"/>
                                                </group>
                                                <group>
                                                    <field name="taxes_id" widget="many2many_tags" domain="[('parent_id','=',False),('type_tax_use','!=','sale')]"/>
                                                    <field name="date_planned" invisible="True"/>
                                                    <field name="account_analytic_id" colspan="2" groups="purchase.group_analytic_accounting"/>
                                                    <field name="company_id" groups="base.group_multi_company" options="{'no_create': True}"/>
                                                </group>
                                            </group>
                                            <notebook>
                                                <page string="Notes">
                                                    <field name="name"/>
                                                </page>
                                                <page string="Invoices and Incoming Shipments">
                                                    <field name="invoice_lines"/>
                                                    <field name="move_ids"/>
                                                </page>
                                            </notebook>
                                        </sheet>
                                    </form>
                                    <tree string="Purchase Order Lines">
                                        <field name="product_id"
                                               attrs="{'readonly':[('state','!=','draft')],'required':True}"
                                               on_change="onchange_product_id(parent.pricelist_id,product_id,0,False,parent.partner_id, parent.date_order,parent.fiscal_position,date_planned,False,False,parent.state,context)"/>
                                        <field name="name"
                                               attrs="{'readonly':[('state','!=','draft')],'required':True}"/>
                                        <field name="date_planned" invisible="True"/>
                                        <field name="company_id" invisible="True" groups="base.group_multi_company"
                                               options="{'no_create': True}"/>
                                        <field name="account_analytic_id" invisible="True"
                                               groups="purchase.group_analytic_accounting"
                                               domain="[('type','not in',('view','template'))]"/>
                                        <field name="product_qty"
                                               attrs="{'readonly':[('state','!=','draft')],'required':True}"
                                               on_change="onchange_product_id(parent.pricelist_id,product_id,product_qty,product_uom,parent.partner_id,parent.date_order,parent.fiscal_position,date_planned,name,False,parent.state,context)"/>
                                        <field name="product_uom" groups="product.group_uom"
                                               on_change="onchange_product_uom(parent.pricelist_id,product_id,product_qty,product_uom,parent.partner_id, parent.date_order,parent.fiscal_position,date_planned,name,False,parent.state,context)"/>
                                        <field name="price_unit"/>
                                        <field name="taxes_id" widget="many2many_tags"
                                               domain="[('parent_id','=',False),('type_tax_use','!=','sale')]"/>
                                        <field name="price_subtotal"/>
                                        <field name="state" invisible="1"/>
                                    </tree>
                                </field>
                                <group class="oe_subtotal_footer oe_right">
                                    <field invisible="True" name="amount_untaxed" widget="monetary"
                                           options="{'currency_field': 'currency_id'}"/>
                                    <field name="amount_tax" widget="monetary"
                                           options="{'currency_field': 'currency_id'}"/>
                                    <div class="oe_subtotal_footer_separator oe_inline">
                                        <label for="amount_total"/>
                                        <button name="button_dummy"
                                                states="draft" string="(更新)" type="object"
                                                class="oe_edit_only oe_link"/>
                                    </div>
                                    <field name="amount_total" string="合计" nolabel="1"
                                           class="oe_subtotal_footer_separator" widget="monetary"
                                           options="{'currency_field': 'currency_id'}"/>
                                </group>
                                <div class="oe_clear"/>
                                <field name="notes"
                                       attrs="{'readonly':[('state','not in',('draft','sent','confirmed'))]}"
                                       class="oe_inline" placeholder="Terms and conditions..."/>
                            </page>
                            <page string="RFQ &amp; Bid" invisible="True">
                                <group>
                                    <field name="incoterm_id"/>
                                    <field name="bid_date"/>
                                    <field name="bid_validity"/>
                                </group>
                            </page>
                            <page string="Deliveries &amp; Invoices" invisible="True">
                                <group>
                                    <group>
                                        <field name="minimum_planned_date"/>
                                        <field name="location_id" groups="stock.group_locations"/>
                                        <field name="shipped" groups="base.group_no_one"/>
                                    </group>
                                    <group>
                                        <field name="invoice_method"/>
                                        <field name="invoiced"/>
                                        <field name="payment_term_id" options="{'no_open': True, 'no_create': True}"/>
                                        <field name="fiscal_position" attrs="{'readonly': [('invoiced','=', True)]}"/>
                                        <!-- We do not need these fields anymore, the information is in open chatter -->
                                        <field name="validator" groups="base.group_no_one"/>
                                        <field name="date_approve" groups="base.group_no_one"/>
                                    </group>
                                </group>
                            </page>
                        </notebook>
                    </sheet>
                    <div class="oe_chatter">
                        <field name="message_follower_ids" widget="mail_followers"/>
                        <field name="message_ids" widget="mail_thread"/>
                    </div>
                </form>
            </field>
        </record>
        <record id="view_tree_qdodoo_car_in_contract" model="ir.ui.view">
            <field name="name">qdodoo.car.in.contract.tree</field>
            <field name="model">qdodoo.car.in.contract</field>
            <field name="priority">1</field>
            <field name="arch" type="xml">
                <tree string="整车采购">
                    <field name="message_unread" invisible="1"/>
                    <field name="name" string="单号"/>
                    <field name="date_order" string="订单日期"/>
                    <field name="contract_number"/>
                    <field name="contract_date"/>
                    <field name="partner_id" string="供应商"/>
                    <field name="last_ship_date"/>
                    <field name="car_number"/>
                    <field name="amount_total" string="金额" sum="合计"/>
                    <field name="state" string="状态"/>
                </tree>
            </field>
        </record>
        <record id="action_qdodoo_car_in_contract" model="ir.actions.act_window">
            <field name="name">整车采购</field>
            <field name="type">ir.actions.act_window</field>
            <field name="res_model">qdodoo.car.in.contract</field>
            <field name="view_type">form</field>
            <field name="view_mode">tree,form</field>
            <field name="domain">[('is_type','=','contract')]</field>
            <field name="view_id" ref="view_tree_qdodoo_car_in_contract"/>
            <field name="search_view_id" ref="view_search_qdodoo_car_in_contract"/>
        </record>
        <menuitem name="整车采购" id="menu_qdodoo_car_in_contract_type" parent="purchase.menu_procurement_management" sequence="41"/>
        <menuitem name="全部" id="menu_qdodoo_car_in_contract" parent="menu_qdodoo_car_in_contract_type"
                  action="action_qdodoo_car_in_contract" sequence="1"/>

        <record id="action_qdodoo_car_in_contract_draft" model="ir.actions.act_window">
            <field name="name">整车采购</field>
            <field name="type">ir.actions.act_window</field>
            <field name="res_model">qdodoo.car.in.contract</field>
            <field name="view_type">form</field>
            <field name="view_mode">tree,form</field>
            <field name="domain">[('is_type','=','contract'),('state','in',('draft','sent'))]</field>
            <field name="view_id" ref="view_tree_qdodoo_car_in_contract"/>
            <field name="search_view_id" ref="view_search_qdodoo_car_in_contract"/>
        </record>
        <menuitem name="草稿" id="menu_qdodoo_car_in_contract_draft" parent="menu_qdodoo_car_in_contract_type"
                  action="action_qdodoo_car_in_contract_draft" sequence="2"/>
        <record id="action_qdodoo_car_in_contract_confirmed" model="ir.actions.act_window">
            <field name="name">整车采购</field>
            <field name="type">ir.actions.act_window</field>
            <field name="res_model">qdodoo.car.in.contract</field>
            <field name="view_type">form</field>
            <field name="view_mode">tree,form</field>
            <field name="domain">[('is_type','=','contract'),('state','=','confirmed')]</field>
            <field name="view_id" ref="view_tree_qdodoo_car_in_contract"/>
            <field name="search_view_id" ref="view_search_qdodoo_car_in_contract"/>
        </record>
        <menuitem name="订单确认" id="menu_qdodoo_car_in_contract_confirmed" parent="menu_qdodoo_car_in_contract_type"
                  action="action_qdodoo_car_in_contract_confirmed" sequence="4"/>
        <record id="action_qdodoo_car_in_contract_approved" model="ir.actions.act_window">
            <field name="name">整车采购</field>
            <field name="type">ir.actions.act_window</field>
            <field name="res_model">qdodoo.car.in.contract</field>
            <field name="view_type">form</field>
            <field name="view_mode">tree,form</field>
            <field name="domain">[('is_type','=','contract'),('state','=','approved')]</field>
            <field name="view_id" ref="view_tree_qdodoo_car_in_contract"/>
            <field name="search_view_id" ref="view_search_qdodoo_car_in_contract"/>
        </record>
        <menuitem name="进口合同" id="menu_qdodoo_car_in_contract_approved" parent="menu_qdodoo_car_in_contract_type"
                  action="action_qdodoo_car_in_contract_approved" sequence="5"/>
        <record id="action_qdodoo_car_in_contract_except_picking" model="ir.actions.act_window">
            <field name="name">整车采购</field>
            <field name="type">ir.actions.act_window</field>
            <field name="res_model">qdodoo.car.in.contract</field>
            <field name="view_type">form</field>
            <field name="view_mode">tree,form</field>
            <field name="domain">[('is_type','=','contract'),('state','=','except_picking')]</field>
            <field name="view_id" ref="view_tree_qdodoo_car_in_contract"/>
            <field name="search_view_id" ref="view_search_qdodoo_car_in_contract"/>
        </record>
        <menuitem name="委托协议" id="menu_qdodoo_car_in_contract_except_picking" parent="menu_qdodoo_car_in_contract_type"
                  action="action_qdodoo_car_in_contract_except_picking" sequence="6"/>
        <record id="action_qdodoo_car_in_contract_lc" model="ir.actions.act_window">
            <field name="name">整车采购</field>
            <field name="type">ir.actions.act_window</field>
            <field name="res_model">qdodoo.car.in.contract</field>
            <field name="view_type">form</field>
            <field name="view_mode">tree,form</field>
            <field name="domain">[('is_type','=','contract'),('state','=','lc')]</field>
            <field name="view_id" ref="view_tree_qdodoo_car_in_contract"/>
            <field name="search_view_id" ref="view_search_qdodoo_car_in_contract"/>
        </record>
        <menuitem name="支付货款" id="menu_qdodoo_car_in_contract_lc" parent="menu_qdodoo_car_in_contract_type"
                  action="action_qdodoo_car_in_contract_lc" sequence="7"/>
        <record id="action_qdodoo_car_in_contract_customs" model="ir.actions.act_window">
            <field name="name">整车采购</field>
            <field name="type">ir.actions.act_window</field>
            <field name="res_model">qdodoo.car.in.contract</field>
            <field name="view_type">form</field>
            <field name="view_mode">tree,form</field>
            <field name="domain">[('is_type','=','contract'),('state','=','customs')]</field>
            <field name="view_id" ref="view_tree_qdodoo_car_in_contract"/>
            <field name="search_view_id" ref="view_search_qdodoo_car_in_contract"/>
        </record>
        <menuitem name="收货通知" id="menu_qdodoo_car_in_contract_customs" parent="menu_qdodoo_car_in_contract_type"
                  action="action_qdodoo_car_in_contract_customs" sequence="8"/>
        <record id="action_qdodoo_car_in_contract_customs_dec" model="ir.actions.act_window">
            <field name="name">整车采购</field>
            <field name="type">ir.actions.act_window</field>
            <field name="res_model">qdodoo.car.in.contract</field>
            <field name="view_type">form</field>
            <field name="view_mode">tree,form</field>
            <field name="domain">[('is_type','=','contract'),('state','not in',('draft','sent','done','cancel'))]</field>
            <field name="view_id" ref="view_tree_qdodoo_car_in_contract"/>
            <field name="search_view_id" ref="view_search_qdodoo_car_in_contract"/>
        </record>
        <menuitem name="报关报检" id="menu_qdodoo_car_in_contract_customs_dec" parent="menu_qdodoo_car_in_contract_type"
                  action="action_qdodoo_car_in_contract_customs_dec" sequence="9"/>
        <record id="action_qdodoo_car_in_contract_car" model="ir.actions.act_window">
            <field name="name">整车采购</field>
            <field name="type">ir.actions.act_window</field>
            <field name="res_model">qdodoo.car.in.contract</field>
            <field name="view_type">form</field>
            <field name="view_mode">tree,form</field>
            <field name="domain">[('is_type','=','contract'),('state','=','car')]</field>
            <field name="view_id" ref="view_tree_qdodoo_car_in_contract"/>
            <field name="search_view_id" ref="view_search_qdodoo_car_in_contract"/>
        </record>
        <menuitem name="赎车" id="menu_qdodoo_car_in_contract_car" parent="menu_qdodoo_car_in_contract_type"
                  action="action_qdodoo_car_in_contract_car" sequence="10"/>
        <record id="action_qdodoo_car_in_contract_except_invoice" model="ir.actions.act_window">
            <field name="name">整车采购</field>
            <field name="type">ir.actions.act_window</field>
            <field name="res_model">qdodoo.car.in.contract</field>
            <field name="view_type">form</field>
            <field name="view_mode">tree,form</field>
            <field name="domain">[('is_type','=','contract'),('state','=','except_invoice')]</field>
            <field name="view_id" ref="view_tree_qdodoo_car_in_contract"/>
            <field name="search_view_id" ref="view_search_qdodoo_car_in_contract"/>
        </record>
        <menuitem name="结算" id="menu_qdodoo_car_in_contract_except_invoice" parent="menu_qdodoo_car_in_contract_type"
                  action="action_qdodoo_car_in_contract_except_invoice" sequence="11"/>
        <record id="action_qdodoo_car_in_contract_done" model="ir.actions.act_window">
            <field name="name">整车采购</field>
            <field name="type">ir.actions.act_window</field>
            <field name="res_model">qdodoo.car.in.contract</field>
            <field name="view_type">form</field>
            <field name="view_mode">tree,form</field>
            <field name="domain">[('is_type','=','contract'),('state','=','done')]</field>
            <field name="view_id" ref="view_tree_qdodoo_car_in_contract"/>
            <field name="search_view_id" ref="view_search_qdodoo_car_in_contract"/>
        </record>
        <menuitem name="完成" id="menu_qdodoo_car_in_contract_done" parent="menu_qdodoo_car_in_contract_type"
                  action="action_qdodoo_car_in_contract_done" sequence="12"/>
        <record id="action_qdodoo_car_in_contract_cancel" model="ir.actions.act_window">
            <field name="name">整车采购</field>
            <field name="type">ir.actions.act_window</field>
            <field name="res_model">qdodoo.car.in.contract</field>
            <field name="view_type">form</field>
            <field name="view_mode">tree,form</field>
            <field name="domain">[('is_type','=','contract'),('state','=','cancel')]</field>
            <field name="view_id" ref="view_tree_qdodoo_car_in_contract"/>
            <field name="search_view_id" ref="view_search_qdodoo_car_in_contract"/>
        </record>
        <menuitem name="已取消" id="menu_qdodoo_car_in_contract_cancel" parent="menu_qdodoo_car_in_contract_type"
                  action="action_qdodoo_car_in_contract_cancel" sequence="13"/>

        <record id="action_qdodoo_car_in_contract_lc_new" model="ir.actions.act_window">
            <field name="name">报关报检费用</field>
            <field name="type">ir.actions.act_window</field>
            <field name="res_model">purchase.order</field>
            <field name="view_type">form</field>
            <field name="view_mode">tree,form,graph,calendar</field>
            <field name="domain">[('contract_id_three','!=',False)]</field>
            <field name="view_id" ref="purchase.purchase_order_tree"/>
        </record>
        <menuitem name="报关报检" id="menu_qdodoo_car_lc" parent="menu_qdodoo_shipping_doc"
                  action="action_qdodoo_car_in_contract_lc_new" sequence="3"/>

        <!--进口合同-->
        <record id="view_form_qdodoo_car_in_contract_new" model="ir.ui.view">
            <field name="name">qdodoo.car.in.contract.new.form</field>
            <field name="model">qdodoo.car.in.contract.new</field>
            <field name="arch" type="xml">
                <form string="进口合同" create='false'>
                    <header>
                        <field name="is_payment" invisible="True"/>
                        <field name="new_id" invisible="True"/>
                        <button name="wkf_send_rfq" states="draft" string="电邮" type="object"
                                context="{'contract_id':True,'is_contract':True}" class="oe_highlight"/>
                        <button name="print_quotation" string="打印" type="object" states="draft" class="oe_highlight"
                                groups="base.group_user"/>
                        <button name="btn_message" string="短信" type="object" states="draft" class="oe_highlight"
                                groups="base.group_user"/>
                        <button name="btn_create_contract" string="确认合同" states="draft" type="object"/>
                        <button name="btn_old_contract" string="已签订合同" states="confirmed" type="object"/>
                        <button name="btn_cancel_contract" string="驳回" states="confirmed" type="object"/>
                        <button name="btn_payment_message" string="付款申请" states="approved" type="object"/>
                        <button name="action_cancel" states="draft" string="取消" type="object"/>
                        <field name="state" widget="statusbar"
                               statusbar_visible="draft,confirmed,approved,except_picking,done"
                               statusbar_colors='{"confirm_contract":"red"}' readonly="1"/>
                    </header>
                    <sheet>
                        <div class="oe_title">
                            <h1>
                                <label string="进口合同"/>
                                <field name="name" class="oe_inline" readonly="1"/>
                            </h1>
                        </div>
                        <div class="oe_right oe_button_box" name="buttons">
                            <button name="btn_read_payment_order" icon="gtk-execute" string="账务" type="object"/>
                            <button name="btn_read_entrusted_agency" icon="gtk-execute" string="委托协议" type="object"/>
                            <button name="btn_read_bill_lading" icon="gtk-execute" string="提单" type="object"/>
                        </div>
                        <group>
                            <group>
                                <field name="customer_id" invisible="True"/>
                                <field name="partner_id" readonly="True" string="供应商"
                                       on_change="onchange_partner_id(partner_id, context)"
                                       context="{'search_default_supplier':1, 'default_supplier':1, 'default_customer':0}"
                                       domain="[('supplier','=',True)]"/>
                                <field string="价格表" readonly="True" domain="[('type','=','purchase')]"
                                       name="pricelist_id" groups="product.group_purchase_pricelist"
                                       on_change="onchange_pricelist(pricelist_id, context)"/>
                                <field name="currency_id" string="币别" readonly="True"
                                       groups="base.group_multi_currency"/>
                                <field name="journal_id" invisible='1'/>
                                <field name="supplier_contract_version" domain="[('partner_id','=',partner_id)]"
                                       attrs="{'readonly':[('state','not in',('draft'))]}"/>
                                <field name="car_type" invisible="True"/>
                                <field name="deposit_rate" readonly="True"/>
                                <field name="deposit_amount" readonly="True"/>
                                <field name="deposit_margin" readonly="True"/>
                                <!--<field name="purchase_type" invisible="True"/>-->
                                <field name="new_pay"
                                       attrs="{'readonly':[('state','!=','draft')]}"/>
                                <field name="contract_number" attrs="{'readonly':[('state','not in',('draft','confirmed'))]}"/>
                                <field name="contract_date" attrs="{'readonly':[('state','not in',('draft','confirmed'))]}"/>
                            </group>
                            <group>
                                <field name="receive_id" attrs="{'invisible':[('state','in',('draft','confirmed'))],'readonly':True}"/>
                                <field name="date_order" string="创建日期" readonly="True"/>
                                <field name="purchase_type" attrs="{'required':True,'readonly':[('state','not in',('draft'))]}"/>
                                <field name="old_id" readonly="True" string="源单据"/>
                                <field name="in_port" readonly="True"/>
                                <field name="out_port" readonly="True"/>
                                <!--<field name="partial_shipment" readonly="True"/>-->
                                <!--<field name="trans_shipment" readonly="True"/>-->
                                <field name="payment_type" readonly="True"/>
                                <field name="payment_line" readonly="True"/>
                                <field name="last_ship_date" readonly="True"/>
                                <field name="origin" invisible="True"/>
                                <field name="company_id" string="公司" invisible="True" groups="base.group_multi_company"
                                       options="{'no_create': True}"/>
                                <field name="picking_type_id" invisible="True"
                                       on_change="onchange_picking_type_id(picking_type_id, context)"
                                       domain="[('code','=','incoming')]" options="{'no_create': True}"
                                       context="{'special_shortened_wh_name': True}" groups="stock.group_locations"/>
                                <field name="related_usage" invisible="1"/>
                                <field name="dest_address_id" string="Customer Address"
                                       on_change="onchange_dest_address_id(dest_address_id, context)"
                                       attrs="{'invisible':[('related_usage','!=','customer')],
                                    'required': [('related_usage','=', 'customer')]}"
                                       groups="stock.group_locations"/>
                                <field name="file_name" invisible="True"/>
                                <field name="contract_note" filename="file_name"
                                       attrs="{'invisible':[('state','in',('draft'))],'readonly':[('state','not in',('draft','confirmed'))]}"/>
                            </group>
                        </group>
                        <notebook>
                            <page string="货物明细">
                                <field name="order_line" readonly="True">
                                    <tree string="Purchase Order Lines" editable="bottom">
                                        <field name="product_id"
                                               attrs="{'readonly':[('state','!=','draft')],'required':True}"
                                               on_change="onchange_product_id(parent.pricelist_id,product_id,0,False,parent.partner_id, parent.date_order,parent.fiscal_position,date_planned,False,False,parent.state,context)"/>
                                        <field name="name"
                                               attrs="{'readonly':[('state','!=','draft')],'required':True}"/>
                                        <field name="date_planned" invisible="True"/>
                                        <field name="company_id" invisible="True" groups="base.group_multi_company"
                                               options="{'no_create': True}"/>
                                        <field name="account_analytic_id" invisible="True"
                                               groups="purchase.group_analytic_accounting"
                                               domain="[('type','not in',('view','template'))]"/>
                                        <field name="product_qty"
                                               attrs="{'readonly':[('state','!=','draft')],'required':True}"
                                               on_change="onchange_product_id(parent.pricelist_id,product_id,product_qty,product_uom,parent.partner_id,parent.date_order,parent.fiscal_position,date_planned,name,False,parent.state,context)"/>
                                        <field name="product_uom" groups="product.group_uom"
                                               on_change="onchange_product_uom(parent.pricelist_id,product_id,product_qty,product_uom,parent.partner_id, parent.date_order,parent.fiscal_position,date_planned,name,False,parent.state,context)"/>
                                        <field name="price_unit"/>
                                        <field name="taxes_id" invisible="True" widget="many2many_tags"
                                               domain="[('parent_id','=',False),('type_tax_use','!=','sale')]"/>
                                        <field name="price_subtotal"/>
                                        <field name="state" invisible="1"/>
                                    </tree>
                                </field>
                                <group class="oe_subtotal_footer oe_right">
                                    <field invisible="True" name="amount_untaxed" widget="monetary"
                                           options="{'currency_field': 'currency_id'}"/>
                                    <field invisible="True" name="amount_tax" widget="monetary"
                                           options="{'currency_field': 'currency_id'}"/>
                                    <div class="oe_subtotal_footer_separator oe_inline">
                                        <label for="amount_total"/>
                                        <button name="button_dummy"
                                                states="draft" string="(更新)" type="object"
                                                class="oe_edit_only oe_link"/>
                                    </div>
                                    <field name="amount_total" string="合计" nolabel="1"
                                           class="oe_subtotal_footer_separator" widget="monetary"
                                           options="{'currency_field': 'currency_id'}"/>
                                </group>
                                <div class="oe_clear"/>
                                <field name="notes" readonly="True" class="oe_inline"
                                       placeholder="Terms and conditions..."/>
                            </page>
                            <page string="RFQ &amp; Bid" invisible="True">
                                <group>
                                    <field name="incoterm_id"/>
                                    <field name="bid_date"/>
                                    <field name="bid_validity"/>
                                </group>
                            </page>
                            <page string="Deliveries &amp; Invoices" invisible="True">
                                <group>
                                    <group>
                                        <field name="minimum_planned_date"/>
                                        <field name="location_id" groups="stock.group_locations"/>
                                        <field name="shipped" groups="base.group_no_one"/>
                                    </group>
                                    <group>
                                        <field name="invoice_method"/>
                                        <field name="invoiced"/>
                                        <field name="payment_term_id" options="{'no_open': True, 'no_create': True}"/>
                                        <field name="fiscal_position" attrs="{'readonly': [('invoiced','=', True)]}"/>
                                        <!-- We do not need these fields anymore, the information is in open chatter -->
                                        <field name="validator" groups="base.group_no_one"/>
                                        <field name="date_approve" groups="base.group_no_one"/>
                                    </group>
                                </group>
                            </page>
                        </notebook>
                    </sheet>
                    <div class="oe_chatter">
                        <field name="message_follower_ids" widget="mail_followers"/>
                        <field name="message_ids" widget="mail_thread"/>
                    </div>
                </form>
            </field>
        </record>
        <record id="view_tree_qdodoo_car_in_contract_new" model="ir.ui.view">
            <field name="name">qdodoo.car.in.contract.new.tree</field>
            <field name="model">qdodoo.car.in.contract.new</field>
            <field name="priority">1</field>
            <field name="arch" type="xml">
                <tree string="进口合同" create="false">
                    <field name="message_unread" invisible="1"/>
                    <field name="name" string="单号"/>
                    <field name="date_order" string="订单日期"/>
                    <field name="contract_number"/>
                    <field name="contract_date"/>
                    <field name="partner_id" string="供应商"/>
                    <field name="last_ship_date"/>
                    <field name="car_number"/>
                    <field name="amount_total" string="金额" sum="合计"/>
                    <field name="state" string="状态"/>
                </tree>
            </field>
        </record>
        <record id="action_qdodoo_car_in_contract_new" model="ir.actions.act_window">
            <field name="name">进口合同</field>
            <field name="type">ir.actions.act_window</field>
            <field name="res_model">qdodoo.car.in.contract.new</field>
            <field name="view_type">form</field>
            <field name="view_mode">tree,form</field>
            <field name="domain">[('is_type','=','contract_new')]</field>
            <field name="view_id" ref="view_tree_qdodoo_car_in_contract_new"/>
        </record>
        <menuitem name="进口合同" id="menu_qdodoo_car_in_contract_new_type" parent="purchase.menu_procurement_management" sequence="43"/>
        <menuitem name="全部" id="menu_qdodoo_car_in_contract_new" parent="menu_qdodoo_car_in_contract_new_type"
                  action="action_qdodoo_car_in_contract_new" sequence="1"/>


        <record id="action_qdodoo_car_in_contract_new_draft" model="ir.actions.act_window">
            <field name="name">进口合同</field>
            <field name="type">ir.actions.act_window</field>
            <field name="res_model">qdodoo.car.in.contract.new</field>
            <field name="view_type">form</field>
            <field name="view_mode">tree,form</field>
            <field name="domain">[('is_type','=','contract_new'),('state','=','draft')]</field>
            <field name="view_id" ref="view_tree_qdodoo_car_in_contract_new"/>
        </record>
        <menuitem name="草稿" id="menu_qdodoo_car_in_contract_new_draft" parent="menu_qdodoo_car_in_contract_new_type"
                  action="action_qdodoo_car_in_contract_new_draft" sequence="2"/>
        <record id="action_qdodoo_car_in_contract_new_confirmed" model="ir.actions.act_window">
            <field name="name">进口合同</field>
            <field name="type">ir.actions.act_window</field>
            <field name="res_model">qdodoo.car.in.contract.new</field>
            <field name="view_type">form</field>
            <field name="view_mode">tree,form</field>
            <field name="domain">[('is_type','=','contract_new'),('state','=','confirmed')]</field>
            <field name="view_id" ref="view_tree_qdodoo_car_in_contract_new"/>
        </record>
        <menuitem name="合同签订" id="menu_qdodoo_car_in_contract_new_confirmed" parent="menu_qdodoo_car_in_contract_new_type"
                  action="action_qdodoo_car_in_contract_new_confirmed" sequence="3"/>
        <record id="action_qdodoo_car_in_contract_new_approved" model="ir.actions.act_window">
            <field name="name">进口合同</field>
            <field name="type">ir.actions.act_window</field>
            <field name="res_model">qdodoo.car.in.contract.new</field>
            <field name="view_type">form</field>
            <field name="view_mode">tree,form</field>
            <field name="domain">[('is_type','=','contract_new'),('state','=','approved')]</field>
            <field name="view_id" ref="view_tree_qdodoo_car_in_contract_new"/>
        </record>
        <menuitem name="支付定金" id="menu_qdodoo_car_in_contract_new_approved" parent="menu_qdodoo_car_in_contract_new_type"
                  action="action_qdodoo_car_in_contract_new_approved" sequence="4"/>
        <record id="action_qdodoo_car_in_contract_new_except_picking" model="ir.actions.act_window">
            <field name="name">进口合同</field>
            <field name="type">ir.actions.act_window</field>
            <field name="res_model">qdodoo.car.in.contract.new</field>
            <field name="view_type">form</field>
            <field name="view_mode">tree,form</field>
            <field name="domain">[('is_type','=','contract_new'),('state','=','except_picking')]</field>
            <field name="view_id" ref="view_tree_qdodoo_car_in_contract_new"/>
        </record>
        <menuitem name="合同执行" id="menu_qdodoo_car_in_contract_new_except_picking" parent="menu_qdodoo_car_in_contract_new_type"
                  action="action_qdodoo_car_in_contract_new_except_picking" sequence="5"/>
        <record id="action_qdodoo_car_in_contract_new_done" model="ir.actions.act_window">
            <field name="name">进口合同</field>
            <field name="type">ir.actions.act_window</field>
            <field name="res_model">qdodoo.car.in.contract.new</field>
            <field name="view_type">form</field>
            <field name="view_mode">tree,form</field>
            <field name="domain">[('is_type','=','contract_new'),('state','=','done')]</field>
            <field name="view_id" ref="view_tree_qdodoo_car_in_contract_new"/>
        </record>
        <menuitem name="完成" id="menu_qdodoo_car_in_contract_new_done" parent="menu_qdodoo_car_in_contract_new_type"
                  action="action_qdodoo_car_in_contract_new_done" sequence="6"/>
        <record id="action_qdodoo_car_in_contract_new_cancel" model="ir.actions.act_window">
            <field name="name">进口合同</field>
            <field name="type">ir.actions.act_window</field>
            <field name="res_model">qdodoo.car.in.contract.new</field>
            <field name="view_type">form</field>
            <field name="view_mode">tree,form</field>
            <field name="domain">[('is_type','=','contract_new'),('state','=','cancel')]</field>
            <field name="view_id" ref="view_tree_qdodoo_car_in_contract_new"/>
        </record>
        <menuitem name="已取消" id="menu_qdodoo_car_in_contract_new_cancel" parent="menu_qdodoo_car_in_contract_new_type"
                  action="action_qdodoo_car_in_contract_new_cancel" sequence="7"/>


        <!--原采购订单数据过滤-->
        <record id="purchase.purchase_rfq" model="ir.actions.act_window">
            <field name="name">Requests for Quotation</field>
            <field name="type">ir.actions.act_window</field>
            <field name="res_model">purchase.order</field>
            <field name="context">{}</field>
            <field name="domain">[('state','in',('draft','sent','bid','cancel', 'confirmed')),('is_type','not in',('contract','contract_new'))]
            </field>
            <field name="view_mode">tree,form,graph,calendar</field>
            <field name="search_view_id" ref="purchase.view_purchase_order_filter"/>
            <field name="help" type="html">
                <p class="oe_view_nocontent_create">
                    Click to create a request for quotation.
                </p>
                <p>
                    The quotation contains the history of the discussion/negotiation
                    you had with your supplier. Once confirmed, a request for
                    quotation is converted into a purchase order.
                </p>
                <p>
                    Most propositions of purchase orders are created automatically
                    by Odoo based on inventory needs.
                </p>
            </field>
        </record>
        <record id="purchase.purchase_form_action" model="ir.actions.act_window">
            <field name="name">Purchase Orders</field>
            <field name="type">ir.actions.act_window</field>
            <field name="res_model">purchase.order</field>
            <field name="view_mode">tree,form,graph,calendar</field>
            <field name="context">{}</field>
            <field name="domain">[('state','not in',('draft','sent','bid', 'confirmed')),('is_type','not in',('contract','contract_new'))]
            </field>
            <field name="search_view_id" ref="purchase.view_purchase_order_filter"/>
            <field name="help" type="html">
                <p class="oe_view_nocontent_create">
                    Click to create a quotation that will be converted into a purchase order.
                </p>
                <p>
                    Use this menu to search within your purchase orders by
                    references, supplier, products, etc. For each purchase order,
                    you can track the related discussion with the supplier, control
                    the products received and control the supplier invoices.
                </p>
            </field>
        </record>

        <!--付款通知单-->
        <record id="view_qdodoo_payment_order_form" model="ir.ui.view">
            <field name="name">qdodoo.payment.order.form</field>
            <field name="model">qdodoo.payment.order</field>
            <field name="arch" type="xml">
                <form string="Payment Order">
                    <header>
                        <field name="agency_id" invisible="True"/>
                        <button name="btn_appliy" states="draft" string="申请" class="oe_highlight" type="object"/>
                        <button name="btn_confirm" states="confirmed" string="确认" class="oe_highlight" type="object"/>
                        <button name="btn_confirm_new" states="open" string="批准付款" class="oe_highlight" type="object"/>
                        <button name="btn_pay_end" states="pay" string="确认付款" class="oe_highlight" type="object"/>
                        <button name="btn_cancel" states="confirmed,open,pay" string="驳回" class="oe_highlight"
                                type="object"/>
                        <button name="btn_select_order"
                                attrs="{'invisible':['|',('state','!=','done'),('agency_id','!=',False)]}" states="done"
                                string="查看发票" type="object"/>
                        <button name="cancel" states="draft" string="取消" type="object"/>
                        <field name="state" widget="statusbar" statusbar_visible="draft,confirmed,open,pay,done"/>
                    </header>
                    <sheet string="Payment order">
                        <div class="oe_title">
                            <label string="收付款申请单" class="oe_edit_only"/>
                            <h1>
                                <field name="reference" readonly="True"/>
                            </h1>
                        </div>
                        <div class=" oe_right oe_button_box">
                            <button class="oe_inline oe_stat_button oe_right"
                                    name="%(account_payment.action_create_payment_order)d" string="Invoices"
                                    Help="Select Invoices to Pay"
                                    type="action" attrs="{'invisible':[('state','=','done')]}" icon="fa-pencil-square-o"
                                    widget="statinfo"/>
                        </div>
                        <group>
                            <group>
                                <field name="pay_type" invisible="True"/>
                                <field name="partner_qdodoo_id" attrs="{'readonly':[('state','!=','draft')]}"/>
                                <field name="mode"
                                       attrs="{'readonly':[('state','!=','pay')],'required':[('state','=','pay')],'invisible':[('state','not in',('cancel','pay','done'))]}"/>
                            </group>
                            <group>
                                <field name="application_date" readonly="True"/>
                                <field name="user_id" string="申请人" readonly="True"
                                       context="{'default_groups_ref': ['base.group_user', 'base.group_partner_manager', 'account.group_account_invoice']}"/>
                                <field name="date_prefered" string="计划付款时间"
                                       attrs="{'readonly':[('state','!=','draft')],'required':True}"/>
                                <field name="date_scheduled" string="预定日期"
                                       attrs="{'readonly':['|',('date_prefered','!=','fixed'),('state','!=','draft')]}"/>
                                <field name="company_id" attrs="{'readonly':[('state','!=','draft')]}"
                                       widget='selection' groups="base.group_multi_company"/>
                            </group>
                        </group>
                        <field name="line_ids" context="{'order_id': active_id or False}"
                               attrs="{'readonly':[('state','!=','draft')]}">
                            <form string="Payment Line">
                                <notebook>
                                    <page string="Payment">
                                        <group col="4">
                                            <field name="move_line_id"
                                                   on_change="onchange_move_line(move_line_id,parent.mode,parent.date_prefered,parent.date_scheduled,currency,company_currency)"
                                                   domain="[('reconcile_id','=', False), ('credit', '>',0), ('account_id.reconcile', '=', True),('amount_to_pay','>', 0)] "/>
                                            <separator colspan="4" string="Transaction Information"/>
                                            <field name="date" string="申请付款时间"/>
                                            <field name="invoice_id"/>
                                            <label for="amount_currency" string="Amount"/>
                                            <div>
                                                <field name="amount_currency"
                                                       on_change="onchange_amount(amount_currency,currency,company_currency)"
                                                       class="oe_inline"/>
                                                <field name="currency" nolabel="1" class="oe_inline"/>
                                            </div>
                                            <field name="partner_id"
                                                   on_change="onchange_partner(partner_id,parent.mode)"/>
                                            <field domain="[('partner_id','=',partner_id)]" name="bank_id"
                                                   string="业务伙伴银行账号"/>
                                            <separator colspan="2" string="Owner Account"/>
                                            <separator colspan="2" string="Destination Account"/>
                                            <field colspan="2" name="info_owner" nolabel="1"/>
                                            <field colspan="2" name="info_partner" nolabel="1"/>
                                            <field colspan="4" name="communication" string="源单据" readonly="True"/>
                                            <field colspan="4" name="communication2" required="True" string="事由摘要"/>
                                            <field name="name"/>
                                            <field name="state"/>
                                            <field name="company_id" widget="selection"
                                                   groups="base.group_multi_company"/>
                                        </group>
                                    </page>
                                    <page string="Information">
                                        <group col="4" string="General Information">
                                            <label for="amount" groups="base.group_multi_currency"/>
                                            <div groups="base.group_multi_currency">
                                                <field name="amount" class="oe_inline"/>
                                                <field name="company_currency" class="oe_inline"/>
                                            </div>
                                            <separator colspan="4" string="Entry Information"/>
                                            <field name="create_date" readonly="1"/>
                                            <field name="ml_maturity_date"/>
                                            <field name="ml_inv_ref"/>
                                        </group>
                                    </page>
                                </notebook>
                            </form>
                            <tree string="Payment Line">
                                <field name="ml_inv_ref"/>
                                <field name="partner_id"/>
                                <field name="invoice_id"/>
                                <field name="communication" string="源单据"/>
                                <field name="bank_id" domain="[('partner_id', '=', partner_id)]"/>
                                <field name="ml_maturity_date"/>
                                <field name="date"/>
                                <field name="amount_currency" string="Amount"/>
                                <field name="currency"/>
                                <field name="name"/>
                                <field name="amount" sum="Total in Company Currency" invisible="1"/>
                            </tree>
                        </field>
                    </sheet>
                </form>
            </field>
        </record>
        <record id="view_qdodoo_payment_order_tree" model="ir.ui.view">
            <field name="name">qdodoo.payment.order.tree</field>
            <field name="model">qdodoo.payment.order</field>
            <field eval="4" name="priority"/>
            <field name="arch" type="xml">
                <tree colors="blue:state == 'draft';gray:state in ('cancel','done');black:state == 'open'"
                      string="Payment order">
                    <field name="reference" string="单号"/>
                    <field name="pay_type"/>
                    <!--<field name="mode" string="单号"/>-->
                    <field name="user_id" string="申请人"/>
                    <field name="partner_qdodoo_id"/>
                    <field name="date_created" string="申请日期"/>
                    <field name="date_done" string="执行日期"/>
                    <field name="total" string="金额"/>
                    <field name="state" string="状态"/>
                </tree>
            </field>
        </record>
        <record id="action_qdodoo_payment_order" model="ir.actions.act_window">
            <field name="name">收付款申请单</field>
            <field name="type">ir.actions.act_window</field>
            <field name="res_model">qdodoo.payment.order</field>
            <field name="view_type">form</field>
            <field name="view_mode">tree,form</field>
            <field name="domain">[('is_qdodoo','=',True)]</field>
            <field name="view_id" ref="view_qdodoo_payment_order_tree"/>
        </record>
        <menuitem name="付款申请单" id="menu_qdodoo_payment_order" parent="menu_qdodoo_stock_delivery"
                  action="action_qdodoo_payment_order" sequence="1"/>

        <menuitem name="需要付款的单据" id="menu_qdodoo_payment_order_need" parent="menu_qdodoo_stock_delivery" sequence="2"/>

        <menuitem name="整车采购" id="menu_qdodoo_payment_order_need_contract" parent="menu_qdodoo_payment_order_need" sequence="1"
                action="action_qdodoo_car_in_contract_lc"/>
        <menuitem name="进口合同" id="menu_qdodoo_payment_order_need_contract_new" parent="menu_qdodoo_payment_order_need" sequence="2"
                action="action_qdodoo_car_in_contract_new_approved"/>

        <record id="action_qdodoo_redeem_car_formulate" model="ir.actions.act_window">
            <field name="name">赎车</field>
            <field name="type">ir.actions.act_window</field>
            <field name="res_model">qdodoo.redeem.car</field>
            <field name="view_type">form</field>
            <field name="view_mode">tree,form</field>
            <field name="domain">[('state','=','formulate')]</field>
            <field name="view_id" ref="view_tree_qdodoo_redeem_car"/>
        </record>
        <menuitem name="赎车" id="menu_qdodoo_payment_order_need_bill" parent="menu_qdodoo_payment_order_need" sequence="4"
                action="action_qdodoo_redeem_car_formulate"/>
    </data>
</openerp>